function run_map(e,t,a){var i,s="#888888",n="#ffffff",o="#f0f0f0",l="#0050B2",c="#888888",d="#ffffff",r=1,v=1;$(e).css("height",$(e).width()*t.svg_height/t.svg_width);var u=$("#map-bubble");u.length||(u=$('<div id="map-bubble"><div class="map-bubble-content"><div class="map-bubble-img"><img src="/favicon.ico" alt=""></div><a></a><p></p></div><div id="regiontitle"></div></div>')).appendTo(document.body);var h=u.find("#regiontitle");let m=$(".map__scale");m.find(".map__scale-button").bind("click",(function(){var e=$(this).hasClass("scale-plus")?p.scale/.729:.729*p.scale;e=p.correctScale(e);var t=1/p.scale-1/e;p.transX-=t*p.width/2,p.transY-=t*p.height/2,p.scale=e,p.applyTransform()})),t=$.extend({},t,{color:n,stroke:[s,r],onTransform:function(){if(p.scale!=i){p.scale==p.getMaxScale()?m.find(".scale-plus").addClass("inactive"):m.find(".scale-plus").removeClass("inactive"),p.scale==p.getMinScale()?m.find(".scale-minus").addClass("inactive"):m.find(".scale-minus").removeClass("inactive");for(var e=$(p.rootGroup).find(f),t=e.length;t--;)e[t].setStroke(null,r/p.scale);i=p.scale}u.css("display","none")}});var p=vectorMap(e,t);p.addShadowStyle("black",t.shadow,t.shadow,Math.round(.8*t.shadow)),p.onTransform();var f="svg"==p.canvas.mode?"path":"shape";$(p.rootGroup).find(f).each((function(){var e=this.id.split("_")[1];e in a&&a[e].visittext||this.setStroke(c,r/p.scale).setFill(d)}));function g(){p.reorder(),u.hide()}return p.addBubble(u[0],{mouseover:function(e){var t=this.id.split("_")[1];p.reorder(t),t in a?u.show():u.hide(),t in a&&a[t].visittext?(u.addClass("has-news"),u.find("a").text(a[t].visittext).attr("href",a[t].url||"#"),u.find("p").text(a[t].visitdate||""),a[t].image?(u.addClass("has-image"),u.find("img").attr({alt:a[t].visittext,src:a[t].image})):u.removeClass("has-image")):u.removeClass("has-news").removeClass("has-image")},mousemove:function(e){var t=this.id.split("_")[1];if(t in a){var i=e.pageX-(a[t].image?80:25);u.css({top:e.pageY-30-u.height(),left:i})}},click:function(){var e=this.id.split("_")[1];e in a&&a[e].url&&(window.location=a[e].url)},unhover:g}),p.hasTouch||$(e).bind("mouseleave",g),p.makeDraggable(),p.reorder=function(e){p.active_item&&(p.active_code in a&&a[p.active_code].visittext?p.active_item.setStroke(s,r/p.scale).setFill(n):p.active_item.setStroke(c,r/p.scale).setFill(d),"svg"==p.canvas.mode&&p.active_item.setAttribute("style",""),p.active_item=null),e&&!(e in a)&&window.console&&window.console.warn("unknown country: "+e),e&&e in a?(p.active_code=e,p.active_item=p.getPath(e),a[e].visittext?("svg"==p.canvas.mode&&p.active_item.setAttribute("style","filter: url(#inner-shadow-"+p.index+");"),p.active_item.setFill(l).setStroke(o,v/p.scale)):p.active_item.setFill(l).setStroke(o,v/p.scale),p.rootGroup.appendChild(p.active_item),h.text(a[e].title)):h.text("")},p}var options={russia:{svg_width:1e3,svg_height:580,maxScale:"x2.2",shadow:8},world:{svg_width:580,svg_height:326,maxScale:"x4",shadow:3}};window.loadAndRunMap=function(e){var t,a=!1,i=!1;function s(){run_map(document.getElementById("map_"+e),options[e],t)}$((function(){i=!0,a&&options[e].paths&&s()})),$.ajax({url:"mapData.json",dataType:"json",success:function(n){t=n,a=!0,i&&options[e].paths&&s()}}),options[e].paths||$.ajax({url:"mapPaths.json",dataType:"json",success:function(t){options[e].paths=t,i&&a&&s()}})},loadAndRunMap("russia");